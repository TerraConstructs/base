// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`security group Inline Rule Control When context.disableInlineRules is false When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When context.disableInlineRules is false and props.disableInlineRules is false When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When context.disableInlineRules is false and props.disableInlineRules is true When do not allowAllOutbound addIngressRule will add a new external ingress rule even if it could have been inlined 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_vpc_security_group_ingress_rule": {
      "SG1_from0000_086_1C8C2484": {
        "cidr_ipv4": "0.0.0.0/0",
        "description": "An external Rule",
        "from_port": 86,
        "ip_protocol": "tcp",
        "security_group_id": "\${aws_security_group.SG1_BA065B6E.id}",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "to_port": 86
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When neither props.disableInlineRules nor context.disableInlineRules are defined When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When props.disableInlineRules is false When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When props.disableInlineRules is false and context.disableInlineRules is null When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When props.disableInlineRules is true When do not allowAllOutbound addIngressRule will add a new external ingress rule even if it could have been inlined 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_vpc_security_group_ingress_rule": {
      "SG1_from0000_086_1C8C2484": {
        "cidr_ipv4": "0.0.0.0/0",
        "description": "An external Rule",
        "from_port": 86,
        "ip_protocol": "tcp",
        "security_group_id": "\${aws_security_group.SG1_BA065B6E.id}",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "to_port": 86
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When props.disableInlineRules is true and context.disableInlineRules is null When do not allowAllOutbound addIngressRule will add a new external ingress rule even if it could have been inlined 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_vpc_security_group_ingress_rule": {
      "SG1_from0000_086_1C8C2484": {
        "cidr_ipv4": "0.0.0.0/0",
        "description": "An external Rule",
        "from_port": 86,
        "ip_protocol": "tcp",
        "security_group_id": "\${aws_security_group.SG1_BA065B6E.id}",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "to_port": 86
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;

exports[`security group Inline Rule Control When props.disableInlineRules is undefined and context.disableInlineRules is null When allowAllOutbound new SecurityGroup will create an inline SecurityGroupEgress rule to allow all traffic 1`] = `
"{
  "data": {
    "aws_availability_zones": {
      "AvailabilityZones": {
        "provider": "aws"
      }
    },
    "aws_caller_identity": {
      "CallerIdentity": {
        "provider": "aws"
      }
    },
    "aws_partition": {
      "Partitition": {
        "provider": "aws"
      }
    }
  },
  "provider": {
    "aws": [
      {
        "region": "us-east-1"
      }
    ]
  },
  "resource": {
    "aws_eip": {
      "VPC_PublicSubnet1_EIP_6AD938E8": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_EIP_4947BC00": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_EIP_AD4BC883": {
        "domain": "vpc",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway": {
      "VPC_IGW_B7E252D3": {
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_internet_gateway_attachment": {
      "VPC_VPCGW_99B986DC": {
        "internet_gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_nat_gateway": {
      "VPC_PublicSubnet1_NATGateway_E0556630": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet1_EIP_6AD938E8.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet1_RouteTableAssociation_0B0896DC",
          "aws_route.VPC_PublicSubnet1_DefaultRoute_91CEF279"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet2_NATGateway_3C070193": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet2_EIP_4947BC00.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet2_RouteTableAssociation_5A808732",
          "aws_route.VPC_PublicSubnet2_DefaultRoute_B7481BBA"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      },
      "VPC_PublicSubnet3_NATGateway_D3048F5C": {
        "allocation_id": "\${aws_eip.VPC_PublicSubnet3_EIP_AD4BC883.allocation_id}",
        "depends_on": [
          "aws_route_table_association.VPC_PublicSubnet3_RouteTableAssociation_427FE0C6",
          "aws_route.VPC_PublicSubnet3_DefaultRoute_A0D29D46"
        ],
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}",
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    },
    "aws_route": {
      "VPC_PrivateSubnet1_DefaultRoute_AE1D6490": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet1_NATGateway_E0556630.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}"
      },
      "VPC_PrivateSubnet2_DefaultRoute_F4F5CFD2": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet2_NATGateway_3C070193.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}"
      },
      "VPC_PrivateSubnet3_DefaultRoute_27F311AE": {
        "destination_cidr_block": "0.0.0.0/0",
        "nat_gateway_id": "\${aws_nat_gateway.VPC_PublicSubnet3_NATGateway_D3048F5C.id}",
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}"
      },
      "VPC_PublicSubnet1_DefaultRoute_91CEF279": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}"
      },
      "VPC_PublicSubnet2_DefaultRoute_B7481BBA": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}"
      },
      "VPC_PublicSubnet3_DefaultRoute_A0D29D46": {
        "depends_on": [
          "aws_internet_gateway_attachment.VPC_VPCGW_99B986DC"
        ],
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "\${aws_internet_gateway.VPC_IGW_B7E252D3.id}",
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}"
      }
    },
    "aws_route_table": {
      "VPC_PrivateSubnet1_RouteTable_BE8A6027": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_RouteTable_0A19E10E": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_RouteTable_192186F8": {
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_RouteTable_FEE4B781": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_RouteTable_6F1A15F1": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_RouteTable_98AE0E14": {
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_route_table_association": {
      "VPC_PrivateSubnet1_RouteTableAssociation_347902D1": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet1_RouteTable_BE8A6027.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet1_05F5A6DA.id}"
      },
      "VPC_PrivateSubnet2_RouteTableAssociation_0C73D413": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet2_RouteTable_0A19E10E.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet2_8C0AEF3A.id}"
      },
      "VPC_PrivateSubnet3_RouteTableAssociation_C28D144E": {
        "route_table_id": "\${aws_route_table.VPC_PrivateSubnet3_RouteTable_192186F8.id}",
        "subnet_id": "\${aws_subnet.VPC_PrivateSubnet3_EAEE5839.id}"
      },
      "VPC_PublicSubnet1_RouteTableAssociation_0B0896DC": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet1_RouteTable_FEE4B781.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet1_0D1B5E48.id}"
      },
      "VPC_PublicSubnet2_RouteTableAssociation_5A808732": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet2_RouteTable_6F1A15F1.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet2_E52FD57B.id}"
      },
      "VPC_PublicSubnet3_RouteTableAssociation_427FE0C6": {
        "route_table_id": "\${aws_route_table.VPC_PublicSubnet3_RouteTable_98AE0E14.id}",
        "subnet_id": "\${aws_subnet.VPC_PublicSubnet3_7031327B.id}"
      }
    },
    "aws_security_group": {
      "SG1_BA065B6E": {
        "description": "TestStack/SG1",
        "egress": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "description": "Allow all outbound traffic by default",
            "from_port": 0,
            "ipv6_cidr_blocks": null,
            "prefix_list_ids": null,
            "protocol": "-1",
            "security_groups": null,
            "self": null,
            "to_port": 0
          }
        ],
        "name": "123e4567-e89b-12d3TestStackSG186E82F1C",
        "tags": {
          "Name": "Test-SG1",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_subnet": {
      "VPC_PrivateSubnet1_05F5A6DA": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.96.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet1",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet2_8C0AEF3A": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.128.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet2",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PrivateSubnet3_EAEE5839": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.160.0/19",
        "map_public_ip_on_launch": false,
        "tags": {
          "Name": "TestStack/VPC/PrivateSubnet3",
          "aws-cdk:subnet-name": "Private",
          "aws-cdk:subnet-type": "Private",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet1_0D1B5E48": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 0)}",
        "cidr_block": "10.0.0.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet1",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet2_E52FD57B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 1)}",
        "cidr_block": "10.0.32.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet2",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      },
      "VPC_PublicSubnet3_7031327B": {
        "availability_zone": "\${element(data.aws_availability_zones.AvailabilityZones.names, 2)}",
        "cidr_block": "10.0.64.0/19",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "TestStack/VPC/PublicSubnet3",
          "aws-cdk:subnet-name": "Public",
          "aws-cdk:subnet-type": "Public",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        },
        "vpc_id": "\${aws_vpc.VPC_B9E5F0B4.id}"
      }
    },
    "aws_vpc": {
      "VPC_B9E5F0B4": {
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "instance_tenancy": "default",
        "tags": {
          "Name": "TestStack/VPC",
          "grid:EnvironmentName": "Test",
          "grid:UUID": "123e4567-e89b-12d3"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "http": {
        "address": "http://localhost:3000"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.88.0"
      }
    }
  }
}"
`;
